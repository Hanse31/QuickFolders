<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <meta name="robots" content="noindex,noarchive,nofollow">
    <title>Bug 25097 &ndash; Forward text message results in double header</title>


<link rel="Top" href="https://www.mozdev.org/bugs/">

  

  


  
    <link rel="Show" title="Dependency Tree"
          href="https://www.mozdev.org/bugs/showdependencytree.cgi?id=25097&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="https://www.mozdev.org/bugs/showdependencygraph.cgi?id=25097">


      <link rel="Show" title="Bug Activity"
            href="https://www.mozdev.org/bugs/show_activity.cgi?id=25097">
      <link rel="Show" title="Printer-Friendly Version"
            href="https://www.mozdev.org/bugs/show_bug.cgi?format=multiple&amp;id=25097">


    

    <script type="text/javascript">
  <!--
  
  function initHelp() {}
  // -->
  </script>

    

    
      <link href="https://www.mozdev.org/bugs/skins/standard/global.css"
            rel="stylesheet"
            type="text/css">
    <!--[if IE]>
      
      <link href="skins/standard/IE-fixes.css"
            rel="stylesheet"
            type="text/css">
    <![endif]-->

    
        <link href="https://www.mozdev.org/bugs/skins/standard/global.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
      <!--[if IE]>
        
        <link href="skins/standard/IE-fixes.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
      <![endif]-->

    

    

    
        <link href="https://www.mozdev.org/bugs/skins/custom/global.css" rel="stylesheet" type="text/css">
    <!--[if IE]>
      
      <link href="skins/custom/IE-fixes.css"
            rel="stylesheet"
            type="text/css">
    <![endif]-->

    <link href="https://www.mozdev.org/sharedimages/mozdev-icon.png" rel="icon" type="image/png">
    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozdev" href="https://www.mozdev.org/bugs/search_plugin.cgi">
                                          
  </head>



  <body onload=""
        class="www-mozdev-org-bugs bz_bug bz_status_RESOLVED bz_component_General bz_bug_25097">




<div id="header">
<div id="banner">
  </div>

<div id="mozdev-logolet">
<table border="0" cellspacing="0" cellpadding="0" id="titles">
<tr>
    <td id="title">
      <p>Bugzilla@Mozdev &ndash; Bug&nbsp;25097</p>
    </td>

    <td id="subtitle">
      <p class="subheader">Forward text message results in double header</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2012-08-23 06:20:10</p>
    </td>
</tr>
</table>
</div>

<ul class="links">
  <li><a href="https://www.mozdev.org/bugs/">Home</a></li>
  <li><span class="separator">| </span><a href="https://www.mozdev.org/bugs/enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="https://www.mozdev.org/bugs/query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="https://www.mozdev.org/bugs/buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input class="txt" type="text" name="quicksearch">
    <input class="btn" type="submit" value="Find" id="find_top"></form></li>

  <li><span class="separator">| </span><a href="https://www.mozdev.org/bugs/report.cgi">Reports</a></li>

  <li>
    <span class="separator">| </span>
      <a href="https://www.mozdev.org/bugs/request.cgi">Requests</a></li>


      <li><span class="separator">| </span><a href="https://www.mozdev.org/bugs/createaccount.cgi">New&nbsp;Account</a></li>
      



      

        
      <li><span class="separator">| </span><a href="https://www.mozdev.org/bugs/show_bug.cgi?id=25097&amp;GoAheadAndLogIn=1">Log&nbsp;In</a></li>
</ul>

</div>

<div id="bugzilla-body">

<i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">No search results available</font></i>

<hr>
<script type="text/javascript">
  <!--

  /* Outputs a link to call replyToComment(); used to reduce HTML output */
  function addReplyLink(id) {
      /* XXX this should really be updated to use the DOM Core's
       * createElement, but finding a container isn't trivial.
       */
      document.write('[<a href="#add_comment" onclick="replyToComment(' + 
                     id + ');">reply<' + '/a>]');
  }

  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id) {
      /* pre id="comment_name_N" */
      var text_elem = document.getElementById('comment_text_'+id);
      var text = getText(text_elem);

      /* make sure we split on all newlines -- IE or Moz use \r and \n
       * respectively.
       */
      text = text.split(/\r|\n/);

      var replytext = "";
      for (var i=0; i < text.length; i++) {
          replytext += "> " + text[i] + "\n"; 
      }

      replytext = "(In reply to comment #" + id + ")\n" + replytext + "\n";


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      textarea.value += replytext;

      textarea.focus();
  }

  if (typeof Node == 'undefined') {
      /* MSIE doesn't define Node, so provide a compatibility object */
      window.Node = {
          TEXT_NODE: 3,
          ENTITY_REFERENCE_NODE: 5
      };
  }

  /* Concatenates all text from element's childNodes. This is used
   * instead of innerHTML because we want the actual text (and
   * innerText is non-standard).
   */
  function getText(element) {
      var child, text = "";
      for (var i=0; i < element.childNodes.length; i++) {
          child = element.childNodes[i];
          var type = child.nodeType;
          if (type == Node.TEXT_NODE || type == Node.ENTITY_REFERENCE_NODE) {
              text += child.nodeValue;
          } else {
              /* recurse into nodes of other types */
              text += getText(child);
          }
      }
      return text;
  }


  function updateCommentTagControl(checkbox, form) {
      if (checkbox.checked) {
          form.comment.className='bz_private';
      } else {
          form.comment.className='';
      }
  }

  //-->
  </script>

<form name="changeform" method="post" action="https://www.mozdev.org/bugs/process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2012-08-23 06:20:10">
  <input type="hidden" name="longdesclength" value="15">
  <input type="hidden" name="id" value="25097">

  
  <table>
    <tr>
      <td valign="top">
        <fieldset>
          <legend>Details</legend>
          <table>

            
            <tr>
              <td align="right">
                <label for="short_desc" accesskey="s"><b><u>S</u>ummary</b></label>:
              </td><td colspan="2">
       <input type="hidden" name="short_desc" id="short_desc"
              value="Forward text message results in double header">Forward text message results in double header
  </td>
            </tr>

            <tr>
              <td colspan="3">
                <table>
                  <tr>
                    
                    <td valign="top"><table cellspacing="1" cellpadding="1">
    <tr>
      <td align="right">
        <b>Bug#</b>:
      </td>
      <td>
        <a href="show_bug.cgi@id=25097.html">25097</a>
      </td>
    </tr>


    <tr>
      <td align="right">
        <label for="product" accesskey="p"><b><u>P</u>roduct</b></label>:
      </td><td>
      <input type="hidden" id="product" name="product" value="smarttemplate4">smarttemplate4
  </td>
    </tr>

    <tr>
      <td align="right">
        <label for="component" accesskey="m"><b><a href="https://www.mozdev.org/bugs/describecomponents.cgi?product=smarttemplate4">Co<u>m</u>ponent</a></b></label>:
      </td><td>
      <input type="hidden" id="component" name="component" value="General">General
  </td>
    </tr>

    <tr>
      <td align="right">
        <b><a href="https://www.mozdev.org/bugs/page.cgi?id=fields.html#status">Status</a></b>:
      </td>
      <td>RESOLVED</td>
    </tr>

    <tr>
      <td align="right">
        <b><a href="https://www.mozdev.org/bugs/page.cgi?id=fields.html#resolution">Resolution</a></b>:
      </td>
      <td>FIXED
      </td>
    </tr>
  </table></td>

                    
                    <td valign="top"><table cellspacing="1" cellpadding="1">
    <tr>
      <td align="right">
        <label for="rep_platform" accesskey="h"><b><u>H</u>ardware</b></label>:
      </td><td>
      <input type="hidden" id="rep_platform" name="rep_platform" value="PC">PC
  </td>
    </tr>

    <tr>
      <td align="right">
        <label for="op_sys" accesskey="o"><b><u>O</u>S</b></label>:
      </td><td>
      <input type="hidden" id="op_sys" name="op_sys" value="Windows 7">Windows 7
  </td>
    </tr>

    <tr>
      <td align="right">
        <label for="version"><b>Version</b></label>:
      </td><td>
      <input type="hidden" id="version" name="version" value="unspecified">unspecified
  </td>
    </tr>

    <tr>
      <td align="right">
        <label for="priority" accesskey="i"><b><a href="https://www.mozdev.org/bugs/page.cgi?id=fields.html#priority">Pr<u>i</u>ority</a></b></label>:
      </td><td>
      <input type="hidden" id="priority" name="priority" value="P2">P2
  </td>
    </tr>

    <tr>
      <td align="right">
        <label for="bug_severity"><b><a href="https://www.mozdev.org/bugs/page.cgi?id=fields.html#bug_severity">Severity</a></b></label>:
      </td><td>
      <input type="hidden" id="bug_severity" name="bug_severity" value="major">major
  </td>
    </tr>

      <tr>
        <td align="right">
          <label for="target_milestone"><b>
            Target Milestone</b></label>:
        </td><td>
      <input type="hidden" id="target_milestone" name="target_milestone" value="---">---
  </td>
      </tr>
  </table></td>
                  </tr>
                </table>
              </td>
            </tr>

            <tr>
              <td colspan="3"><hr size="1"></td>
            </tr>

            

            <tr>
              <td align="right">
                <label for="bug_file_loc" accesskey="u"><b>
                    <u>U</u>RL</b></label>:
              </td><td colspan="2">
       <input type="hidden" name="bug_file_loc" id="bug_file_loc"
              value="">
  </td>
            </tr>

              <tr>
                <td align="right">
                  <label for="status_whiteboard" accesskey="w"><b><u>W</u>hiteboard</b></label>:
                </td><td colspan="2">
       <input type="hidden" name="status_whiteboard" id="status_whiteboard"
              value="">
  </td>
              </tr>

              <tr>
                <td align="right">
                  <label for="keywords" accesskey="k">
                    <b><a href="https://www.mozdev.org/bugs/describekeywords.cgi"><u>K</u>eywords</a></b></label>:
                </td><td colspan="2">
       <input type="hidden" name="keywords" id="keywords"
              value="">
  </td>
              </tr>

            


            

            <tr><th align="right">
    <label for="dependson">Depends&nbsp;on</label>:
  </th>
  <td>
  </td>
  <td>
      <input type="hidden" id="dependson" name="dependson"
             value="">
  </td>
            </tr>

            <tr><th align="right">
    <label for="blocked" accesskey="b"><u>B</u>locks</label>:
  </th>
  <td>
  </td>
  <td>
      <input type="hidden" id="blocked" name="blocked"
             value="">
  </td>
            </tr>

            <tr>
              <th>&nbsp;</th>

              <td colspan="2">
                <a href="https://www.mozdev.org/bugs/showdependencytree.cgi?id=25097&amp;hide_resolved=1">Show
                   dependency tree</a>

                  - <a href="https://www.mozdev.org/bugs/showdependencygraph.cgi?id=25097">Show
                       dependency graph</a>
              </td>
            </tr>
          </table>
        </fieldset>
      </td>

      
      <script type="text/javascript">
        <!--
        var v = document.body.offsetHeight;
        //-->
      </script>

      <td valign="top">
        
        <fieldset>
          <legend>People</legend><table cellpadding="1" cellspacing="1">
    <tr>
      <td align="right">
        <b>Reporter</b>:
      </td>
      <td>
        <a href="mailto:gessel&#64;blackrosetech.com">gessel&#64;blackrosetech.com &lt;gessel&#64;blackrosetech.com&gt;</a>
      </td>
    </tr>

    <tr>
      <td align="right">
        <b><a href="https://www.mozdev.org/bugs/page.cgi?id=fields.html#assigned_to">Assigned&nbsp;To</a></b>:
      </td>
      <td>
        <a href="mailto:axel.grude&#64;gmail.com">Axel Grude &lt;axel.grude&#64;gmail.com&gt;</a>
      </td>
    </tr>



    <tr>
        <td align="right" valign="top">
          <label for="cc"><b>CC</b></label>:
        </td>
        <td valign="top">
          <select id="cc" name="cc" multiple="multiple" size="5">
            <option value="smarttemplate4&#64;posteo.de">smarttemplate4&#64;posteo.de</option>
          </select>
        </td>
    </tr>
  </table>
        </fieldset>

        
      </td>
    </tr>
  </table>



<script type="text/javascript">
  <!--
  function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var rows = table.getElementsByTagName("tr");
    var originalHeight = table.offsetHeight; // Store current height for scrolling

    var toggle;
    if (link.innerHTML == "Show Obsolete") {
      toggle = ""; // This should be 'table-row', but IE 6 doesn't understand it.
      link.innerHTML = "Hide Obsolete";
    }
    else {
      toggle = "none";
      link.innerHTML = "Show Obsolete";
    }

    for (var i = 0; i < rows.length; i++) {
      if (rows[i].className.match('bz_tr_obsolete'))
        rows[i].style.display = toggle;
    }

    var newHeight = table.offsetHeight;
    window.scrollBy(0, newHeight - originalHeight);

    return false;
  }
  //-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr>
    <th colspan="3" align="left">
      <a name="a0" id="a0">Attachments</a>
    </th>
  </tr>


      <tr class="
                 bz_tr_obsolete">
        <td valign="top">
            <a name="a1" href="smartTemplate-0.9.2pre8.xpi"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Attempt at a fix</span></b></a>

          <span class="bz_attach_extra_info">
              (245.90 KB,
                application/x-xpinstall)

            <br>
            <a href="show_bug.cgi@id=25097.html#attach_7346"
               title="Go to the comment associated with the attachment">2012-08-21 12:08</a>,

            <a href="mailto:axel.grude&#64;gmail.com"
               title="Write an email to the creator of the attachment">Axel Grude
            </a>
          </span>
        </td>

          <td class="bz_attach_flags" valign="top">
              <i>no flags</i>
          </td>

        <td valign="top">
          <a href="https://www.mozdev.org/bugs/attachment.cgi?id=7346&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr class="
                 ">
        <td valign="top">
            <a name="a2" href="smartTemplate-0.9.2pre24.xpi.1"
               title="View the content of the attachment">
          <b>test version 24</b></a>

          <span class="bz_attach_extra_info">
              (246.72 KB,
                application/x-xpinstall)

            <br>
            <a href="show_bug.cgi@id=25097.html#attach_7350"
               title="Go to the comment associated with the attachment">2012-08-23 05:36</a>,

            <a href="mailto:axel.grude&#64;gmail.com"
               title="Write an email to the creator of the attachment">Axel Grude
            </a>
          </span>
        </td>

          <td class="bz_attach_flags" valign="top">
              <i>no flags</i>
          </td>

        <td valign="top">
          <a href="https://www.mozdev.org/bugs/attachment.cgi?id=7350&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="3">
        <span class="bz_attach_view_hide">
            <a href="show_bug.cgi@id=25097.html#a0" onClick="return toggle_display(this);">Hide Obsolete</a> (1)
        </span>
      <a href="https://www.mozdev.org/bugs/attachment.cgi?bugid=25097&amp;action=enter">Add an attachment</a>
      (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>




  <br>
  <table cellpadding="1" cellspacing="1">
    <tr>
      <td>
          <fieldset>
            <legend>Note</legend>
            <p>
              You need to
              <a href="https://www.mozdev.org/bugs/show_bug.cgi?id=25097&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </p>
          </fieldset>
      </td>

      <td valign="top">
        <fieldset>
          <legend>Related actions</legend>
          <ul>
            <li><a href="https://www.mozdev.org/bugs/show_activity.cgi?id=25097">View Bug Activity</a></li>
            <li><a href="https://www.mozdev.org/bugs/show_bug.cgi?format=multiple&amp;id=25097">Format For Printing</a></li>
            <li><a href="https://www.mozdev.org/bugs/show_bug.cgi?ctype=xml&amp;id=25097">XML</a></li>
            <li><a href="https://www.mozdev.org/bugs/enter_bug.cgi?cloned_bug_id=25097">Clone This Bug</a></li>
          </ul>


          
        </fieldset>
      </td>
    </tr>
  </table>
  <br>





<hr>

<div id="comments"><script type="text/javascript">
  <!--
  function updateCommentPrivacy(checkbox, id) {
    var comment_elem = document.getElementById('comment_text_'+id).parentNode;
    if (checkbox.checked) {
      if (!comment_elem.className.match('bz_private')) {
        comment_elem.className = comment_elem.className.concat(' bz_private');
      }
    }
    else {
      comment_elem.className =
        comment_elem.className.replace(/(\s*|^)bz_private(\s*|$)/, '$2');
    }
  }
  //-->
  </script>








<div class="bz_comment">
        <table>
          <tr>
            <th align="left">
              <b><a name="c0" href="show_bug.cgi@id=25097.html#c0">
                Description</a>:</b>&nbsp;&nbsp;
            </th>
            <td align="left" width="30%">
              <b>Opened:</b> 2012-08-21 07:51
            </td>
          </tr>
        </table>
        


<pre class="bz_comment_text" >With the latest update of Smart Template 4 (0.7.2 - 0.8.0) in Thunderbird 14 on
Windows 7/x64 when I forward a message (but not when I reply - that works fine)
I get a double header.  The header as formatted by SmartTemplate and the full
header from Thunderbird like this:

-------- Forwarded Message --------
Subject: Mulberry-discuss Digest, Vol 15, Issue 15
From: <a href="mailto:mulberry-discuss-request@lists.mulberrymail.com">mulberry-discuss-request@lists.mulberrymail.com</a>
To: <a href="mailto:mulberry-discuss@lists.mulberrymail.com">mulberry-discuss@lists.mulberrymail.com</a>
Sent: Sun, 28 Oct 2007 21:00:53 -0500 +0300

-------- Original Message --------
Return-Path: &lt;<a href="mailto:mulberry-discuss-bounces@lists.mulberrymail.com">mulberry-discuss-bounces@lists.mulberrymail.com</a>&gt;
X-Original-To: <a href="mailto:myemail@myserver.com">myemail@myserver.com</a>
Delivered-To: <a href="mailto:myemail@myserver.com">myemail@myserver.com</a>
Received: from mulberrymail.com (piper.mulberrymail.com [151.201.22.177])
(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits)) (No client
certificate requested) by claudel.blackrosetech.com (Postfix) with ESMTP id
E26B72E04D for &lt;<a href="mailto:gessel@blackrosetech.com">gessel@blackrosetech.com</a>&gt;; Sun, 28 Oct 2007 19:01:01 -0700
(PDT)
Received: from piper.mulberrymail.com (localhost.localdomain [127.0.0.1]) by
mulberrymail.com (8.13.6/8.13.6) with ESMTP id l9T20uDs015393; Sun, 28 Oct 2007
21:00:57 -0500
From: <a href="mailto:mulberry-discuss-request@lists.mulberrymail.com">mulberry-discuss-request@lists.mulberrymail.com</a>
Subject: Mulberry-discuss Digest, Vol 15, Issue 15
To: <a href="mailto:mulberry-discuss@lists.mulberrymail.com">mulberry-discuss@lists.mulberrymail.com</a>
Reply-To: <a href="mailto:mulberry-discuss@lists.mulberrymail.com">mulberry-discuss@lists.mulberrymail.com</a>
Date: Sun, 28 Oct 2007 21:00:53 -0500
Message-ID:
&lt;<a href="mailto:mailman.2415.1193623253.783.mulberry-discuss@lists.mulberrymail.com">mailman.2415.1193623253.783.mulberry-discuss@lists.mulberrymail.com</a>&gt;
MIME-Version: 1.0
Content-Type: text/plain; charset=&quot;us-ascii&quot;
Content-Transfer-Encoding: 7bit
X-BeenThere: <a href="mailto:mulberry-discuss@lists.mulberrymail.com">mulberry-discuss@lists.mulberrymail.com</a>
X-Mailman-Version: 2.1.8
Precedence: list
List-Id: &lt;mulberry-discuss.lists.mulberrymail.com&gt;
List-Unsubscribe:
&lt;<a href="http://lists.mulberrymail.com/mailman/listinfo/mulberry-discuss">http://lists.mulberrymail.com/mailman/listinfo/mulberry-discuss</a>&gt;,
&lt;<a href="mailto:mulberry-discuss-request@lists.mulberrymail.com">mailto:mulberry-discuss-request@lists.mulberrymail.com</a>?subject=unsubscribe&gt;
List-Archive: &lt;<a href="http://lists.mulberrymail.com/archives/mulberry-discuss">http://lists.mulberrymail.com/archives/mulberry-discuss</a>&gt;
List-Post: &lt;<a href="mailto:mulberry-discuss@lists.mulberrymail.com">mailto:mulberry-discuss@lists.mulberrymail.com</a>&gt;
List-Help:
&lt;<a href="mailto:mulberry-discuss-request@lists.mulberrymail.com">mailto:mulberry-discuss-request@lists.mulberrymail.com</a>?subject=help&gt;
List-Subscribe:
&lt;<a href="http://lists.mulberrymail.com/mailman/listinfo/mulberry-discuss">http://lists.mulberrymail.com/mailman/listinfo/mulberry-discuss</a>&gt;,
&lt;<a href="mailto:mulberry-discuss-request@lists.mulberrymail.com">mailto:mulberry-discuss-request@lists.mulberrymail.com</a>?subject=subscribe&gt;
Sender: <a href="mailto:mulberry-discuss-bounces@lists.mulberrymail.com">mulberry-discuss-bounces@lists.mulberrymail.com</a>
Errors-To: <a href="mailto:mulberry-discuss-bounces@lists.mulberrymail.com">mulberry-discuss-bounces@lists.mulberrymail.com</a>
X-Spam-Status: No, score=-0.9 required=5.0 tests=ALL_TRUSTED,NO_REAL_NAME 
autolearn=disabled version=3.1.1
X-Spam-Checker-Version: SpamAssassin 3.1.1 (2006-03-10) on 
piper.mulberrymail.com
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c1" href="show_bug.cgi@id=25097.html#c1">
            #1</a> From 
          <a href="mailto:axel.grude&#64;gmail.com">Axel Grude</a>
          2012-08-21 08:36:23 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi@id=25097.html#c0">comment #0</a>)
<span class="quote">&gt; With the latest update of Smart Template 4 (0.7.2 - 0.8.0) in Thunderbird 14 on
&gt; Windows 7/x64 when I forward a message (but not when I reply - that works fine)
&gt; I get a double header.  The header as formatted by SmartTemplate and the full
&gt; header from Thunderbird like this:</span >

Just some questions:
Is this the part you are getting twice?

<span class="quote">&gt; -------- Forwarded Message --------
&gt; Subject: Mulberry-discuss Digest, Vol 15, Issue 15
&gt; From: <a href="mailto:mulberry-discuss-request@lists.mulberrymail.com">mulberry-discuss-request@lists.mulberrymail.com</a>
&gt; To: <a href="mailto:mulberry-discuss@lists.mulberrymail.com">mulberry-discuss@lists.mulberrymail.com</a>
&gt; Sent: Sun, 28 Oct 2007 21:00:53 -0500 +0300</span >

Do you use the option 

[x] Disable thunderbird default quote header 

for forwarding?

Finally: Is this happening in HTML or plain text mode?
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c2" href="show_bug.cgi@id=25097.html#c2">
            #2</a> From 
          <a href="mailto:gessel&#64;blackrosetech.com">gessel&#64;blackrosetech.com</a>
          2012-08-21 09:13:24 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" >I get the headers just as I pasted them in - the nice compact header followed
by the very extended verbose header from Tbird:


-------- Original Message --------
.
.
.
piper.mulberrymail.com



The [x] disable thunderbird default quote header box is checked (I double
checked).

It is plain text mode (the One True Way to use email).

The extended header started appearing after the most recent update.  The exact
same template and settings worked fine a version ago.  

Oddly, if I use SmartTemplate for reply, it works fine - just forward comes out
odd.  For example, forwarding the notification from Bugzilla results in:


-------- Forwarded Message --------
Subject: [smarttemplate4] [<span class="bz_closed"><a href="show_bug.cgi@id=25097.html" title="RESOLVED FIXED - Forward text message results in double header">Bug 25097</a></span>] Forward text message results in double
 header
From: <a href="mailto:bugzilla-daemon@mozdev.mozdev.org">bugzilla-daemon@mozdev.mozdev.org</a>
To: <a href="mailto:gessel@blackrosetech.com">gessel@blackrosetech.com</a>
Sent:  Tuesday, August 21, 2012 18:36:24 GMT+0300 AST

-------- Original Message --------
Return-Path: &lt;<a href="mailto:www@mozdev.mozdev.org">www@mozdev.mozdev.org</a>&gt;
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on
claudel.blackrosetech.com
X-Spam-Level: 
X-Spam-Status: No, score=-2.1 required=1.0 tests=AWL,BAYES_00,
RCVD_IN_DNSWL_LOW autolearn=disabled version=3.2.5
X-Original-To: <a href="mailto:gessel@blackrosetech.com">gessel@blackrosetech.com</a>
Delivered-To: <a href="mailto:gessel@blackrosetech.com">gessel@blackrosetech.com</a>
Received: from mozdev.mozdev.org (mozdev.mozdev.org [140.211.166.81]) by
claudel.blackrosetech.com (Postfix) with ESMTP id 173162E051 for
&lt;<a href="mailto:gessel@blackrosetech.com">gessel@blackrosetech.com</a>&gt;; Tue, 21 Aug 2012 08:36:26 -0700 (PDT)
Received: by mozdev.mozdev.org (Postfix, from userid 80) id 921A2844B0; Tue, 21
Aug 2012 08:36:24 -0700 (PDT)
From: <a href="mailto:bugzilla-daemon@mozdev.mozdev.org">bugzilla-daemon@mozdev.mozdev.org</a>
To: <a href="mailto:gessel@blackrosetech.com">gessel@blackrosetech.com</a>
Subject: [smarttemplate4] [<span class="bz_closed"><a href="show_bug.cgi@id=25097.html" title="RESOLVED FIXED - Forward text message results in double header">Bug 25097</a></span>] Forward text message results in double
header
X-Bugzilla-Reason: Reporter
X-Bugzilla-Type: newchanged
X-Bugzilla-Watch-Reason: None
X-Bugzilla-Product: smarttemplate4
X-Bugzilla-Component: General
X-Bugzilla-Keywords: 
X-Bugzilla-Severity: major
X-Bugzilla-Who: <a href="mailto:axel.grude@gmail.com">axel.grude@gmail.com</a>
X-Bugzilla-Status: NEW
X-Bugzilla-Priority: P2
X-Bugzilla-Assigned-To: <a href="mailto:axel.grude@gmail.com">axel.grude@gmail.com</a>
X-Bugzilla-Target-Milestone: ---
X-Bugzilla-Changed-Fields: 
In-Reply-To: &lt;<a href="mailto:bug-25097-24665@https.www.mozdev.org">bug-25097-24665@https.www.mozdev.org</a>/bugs/&gt;
References: &lt;<a href="mailto:bug-25097-24665@https.www.mozdev.org">bug-25097-24665@https.www.mozdev.org</a>/bugs/&gt;
Content-Type: text/plain; charset=&quot;UTF-8&quot;
MIME-Version: 1.0
Message-Id: &lt;<a href="mailto:20120821153624.921A2844B0@mozdev.mozdev.org">20120821153624.921A2844B0@mozdev.mozdev.org</a>&gt;
Date: Tue, 21 Aug 2012 08:36:24 -0700 (PDT)
X-File-To: INB
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c3" href="show_bug.cgi@id=25097.html#c3">
            #3</a> From 
          <a href="mailto:axel.grude&#64;gmail.com">Axel Grude</a>
          2012-08-21 10:45:15 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi@id=25097.html#c2">comment #2</a>)
<span class="quote">&gt; I get the headers just as I pasted them in - the nice compact header followed
&gt; by the very extended verbose header from Tbird:</span >

Okay - if I understand correctly somehow the complete Header of the Mail gets
pasted into the body of the Email, after the Header composed by smartTemplate4.

Very peculiar. we have a way of showing the complete Header in the error
console, but it should not actually be inserted into the _email_ itself.
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c4" href="show_bug.cgi@id=25097.html#c4">
            #4</a> From 
          <a href="mailto:gessel&#64;blackrosetech.com">gessel&#64;blackrosetech.com</a>
          2012-08-21 10:53:02 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" >That does sound like the problem.  Perhaps I have a corrupted prefs file if
nobody else is seeing it.  I can't be the only one using plain text...
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c5" href="show_bug.cgi@id=25097.html#c5">
            #5</a> From 
          <a href="mailto:axel.grude&#64;gmail.com">Axel Grude</a>
          2012-08-21 11:12:27 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi@id=25097.html#c4">comment #4</a>)
<span class="quote">&gt; That does sound like the problem.  Perhaps I have a corrupted prefs file if
&gt; nobody else is seeing it.  I can't be the only one using plain text...
&gt; </span >

Obviously you are the only one who tested it (forwarding in plain text) ;-)

I was able to reproduce it by simply forwarding a newsgroup mail. Bug accepted,
expect a patch shortly.
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c6" href="show_bug.cgi@id=25097.html#c6">
            #6</a> From 
          <a href="mailto:axel.grude&#64;gmail.com">Axel Grude</a>
          2012-08-21 11:18:46 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi@id=25097.html#c4">comment #4</a>)
<span class="quote">&gt; That does sound like the problem.  Perhaps I have a corrupted prefs file if
&gt; nobody else is seeing it.  I can't be the only one using plain text...
&gt; </span >

Ok, I found the answer - but you won't like it :S

The full header is currently inserted by Thunderbird _even if you disable
smartTemplate4_  ich double checked the code twice in the debugger and then
decided st4 wasn't actually putting that header in there. Disabled st4 and
voila complete header still in mail text. You have found a Thunderbird bug. I
will get on to the maildev group on IRC and ask them if there is a known
regression around this.
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c7" href="show_bug.cgi@id=25097.html#c7">
            #7</a> From 
          <a href="mailto:axel.grude&#64;gmail.com">Axel Grude</a>
          2012-08-21 11:36:43 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi@id=25097.html#c6">comment #6</a>)
<span class="quote">&gt; (In reply to <a href="show_bug.cgi@id=25097.html#c4">comment #4</a>)
&gt; &gt; That does sound like the problem.  Perhaps I have a corrupted prefs file if
&gt; &gt; nobody else is seeing it.  I can't be the only one using plain text...
&gt; &gt; 
&gt; 
&gt; Ok, I found the answer - but you won't like it :S
&gt; 
&gt; The full header is currently inserted by Thunderbird _even if you disable
&gt; smartTemplate4_  ich double checked the code twice in the debugger and then
&gt; decided st4 wasn't actually putting that header in there. Disabled st4 and
&gt; voila complete header still in mail text. You have found a Thunderbird bug. I
&gt; will get on to the maildev group on IRC and ask them if there is a known
&gt; regression around this.
&gt; </span >

Maybe a bit to fast setting this to INVALID, reopening it. Can you set View /
Headers to Normal?
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c8" href="show_bug.cgi@id=25097.html#c8">
            #8</a> From 
          <a href="mailto:axel.grude&#64;gmail.com">Axel Grude</a>
          2012-08-21 12:08:09 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" ><span class="bz_obsolete"><a href="smartTemplate-0.9.2pre8.xpi" name="attach_7346" title="Attempt at a fix">Created an attachment (id=7346)</a> <a href="https://www.mozdev.org/bugs/attachment.cgi?id=7346&amp;action=edit" title="Attempt at a fix">[details]</a></span>
Attempt at a fix

Here is an attempt to fix this - there is at least one caveat:

the very first line &quot;On Thursday, November 5, 2009 1:29:03 AM UTC-5, xyz
wrote:&quot; cannot be safely removed.

There might be attachments that influence the header in a way that might make
it impossible to safely delete just the header information - in text mode there
is no dedicated container for this, so the original code (and now this patched
version) searches for 2 consecutive &lt;br&gt; (line breaks) in order to stop
deleting headers. You can imagine that this may wreak havoc if there are other
extensions (or the behavior of thunderbird itself) changes in a way that these
are not present anymore - this can lead to the complete original email or at
least the first quoted mail being deleted... so please test with caution.
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c9" href="show_bug.cgi@id=25097.html#c9">
            #9</a> From 
          <a href="mailto:gessel&#64;blackrosetech.com">gessel&#64;blackrosetech.com</a>
          2012-08-21 12:47:33 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" >Set view headers to normal and get

-------- Forwarded Message --------
Subject: Accidental Spills and Falls
From: Jameco Electronics &lt;<a href="mailto:email@jamecoelectronics.messages1.com">email@jamecoelectronics.messages1.com</a>&gt;
To: <a href="mailto:gessel@blackrosetech.com">gessel@blackrosetech.com</a>
Sent:  Tuesday, August 21, 2012 21:16:07 GMT+0300 AST

-------- Original Message --------
Subject:        Accidental Spills and Falls
Date:   Tue, 21 Aug 2012 18:16:07 +0000 (GMT)
From:   Jameco Electronics &lt;<a href="mailto:email@jamecoelectronics.messages1.com">email@jamecoelectronics.messages1.com</a>&gt;
Reply-To:       <a href="mailto:email@jamecoelectronics.messages1.com">email@jamecoelectronics.messages1.com</a>
To:     <a href="mailto:gessel@blackrosetech.com">gessel@blackrosetech.com</a>


Funny how Thunderbird's reply template is so different from the forward
template.  The internal reply template is quite acceptable:

-------- Original Message --------
Subject: Accidental Spills and Falls
From: Jameco Electronics &lt;<a href="mailto:email@jamecoelectronics.messages1.com">email@jamecoelectronics.messages1.com</a>&gt;
To: <a href="mailto:gessel@blackrosetech.com">gessel@blackrosetech.com</a>
Date: Tue Aug 21 2012 21:16:07 GMT+0300 (Arabic Standard Time)


It looks to me that everything between the first --- and the first &lt;br&gt;&lt;br&gt; is
reliably the headers.  Any deletion would just happen to the quoted text, no? 
Not to the original message... would it?
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c10" href="show_bug.cgi@id=25097.html#c10">
            #10</a> From 
          <a href="mailto:axel.grude&#64;gmail.com">Axel Grude</a>
          2012-08-21 17:23:40 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi@id=25097.html#c9">comment #9</a>)
<span class="quote">&gt; 
&gt; Funny how Thunderbird's reply template is so different from the forward
&gt; template.  The internal reply template is quite acceptable:
&gt; 
&gt; -------- Original Message --------
&gt; Subject: Accidental Spills and Falls
&gt; From: Jameco Electronics &lt;<a href="mailto:email@jamecoelectronics.messages1.com">email@jamecoelectronics.messages1.com</a>&gt;
&gt; To: <a href="mailto:gessel@blackrosetech.com">gessel@blackrosetech.com</a>
&gt; Date: Tue Aug 21 2012 21:16:07 GMT+0300 (Arabic Standard Time)
&gt; 
&gt; 
&gt; It looks to me that everything between the first --- and the first &lt;br&gt;&lt;br&gt; is
&gt; reliably the headers. Any deletion would just happen to the quoted text, no? </span >

<span class="quote">&gt; Not to the original message... would it?
&gt; </span >

the  original message is also quoted text, unless you attach the message. I
think we can say it works for you on your system (with the extensions that you
have installed). But can one ever be sure?

So did the patch work for you?

:-)
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c11" href="show_bug.cgi@id=25097.html#c11">
            #11</a> From 
          <a href="mailto:gessel&#64;blackrosetech.com">gessel&#64;blackrosetech.com</a>
          2012-08-21 17:26:01 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" >Perfecto!

forward header with smarttemplate

-------- Forwarded Message --------
Subject: Mulberry-discuss Digest, Vol 15, Issue 15
From: <a href="mailto:mulberry-discuss-request@lists.mulberrymail.com">mulberry-discuss-request@lists.mulberrymail.com</a>
To: <a href="mailto:mulberry-discuss@lists.mulberrymail.com">mulberry-discuss@lists.mulberrymail.com</a>
Sent: Monday, October 29, 2007 05:00:53 GMT+0300 AST




Single header goodness and formatting flexibility achieved!

Nice programing, Axel!  Very impressive work and turn around time.  Now to the
real problem: why aren't people using plain text?  Clogging up the tubes with
HTML headers and font declarations...  kids these days.

Smarttemplate template to achieve this forwarded message header formatting
perfection, just in case anyone is looking:

-------- Forwarded Message --------
Subject: %subject%
From: %from%
To: %to%
Sent: %X:=sent%%datelocal% GMT%date_tz% %tz_name%


(And that was twice today we simultaneously committed: my first two bugzilla
mid-air collisions.)
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c12" href="show_bug.cgi@id=25097.html#c12">
            #12</a> From 
          <a href="mailto:gessel&#64;blackrosetech.com">gessel&#64;blackrosetech.com</a>
          2012-08-22 02:41:52 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" >Bummer - fix works for forwarding but not reply.    It seems to strip all the
&lt;br&gt; or &lt;lf&gt; (not sure)

SmartTemplate:

-------- Original Message --------
Subject: Mulberry-discuss Digest, Vol 15, Issue 15
From: <a href="mailto:mulberry-discuss-request@lists.mulberrymail.com">mulberry-discuss-request@lists.mulberrymail.com</a>
To: <a href="mailto:mulberry-discuss@lists.mulberrymail.com">mulberry-discuss@lists.mulberrymail.com</a>
Sent: Monday, October 29, 2007 05:00:53 GMT+0300 Arabic Standard Time&gt; Send
Mulberry-discuss mailing list submissions to&gt;      
<a href="mailto:mulberry-discuss@lists.mulberrymail.com">mulberry-discuss@lists.mulberrymail.com</a>&gt; &gt; To subscribe or unsubscribe via the
World Wide Web, visit&gt;  
<a href="http://lists.mulberrymail.com/mailman/listinfo/mulberry-discuss">http://lists.mulberrymail.com/mailman/listinfo/mulberry-discuss</a>&gt; or, via email,
send a message with subject or body 'help' to&gt; 
<a href="mailto:mulberry-discuss-request@lists.mulberrymail.com">mulberry-discuss-request@lists.mulberrymail.com</a>&gt; &gt; You can reach the person
managing the list at&gt;       <a href="mailto:mulberry-discuss-owner@lists.mulberrymail.com">mulberry-discuss-owner@lists.mulberrymail.com</a>&gt; &gt;
When replying, please edit your Subject line so it is more specific&gt; than &quot;Re:
Contents of Mulberry-discuss digest...&quot;&gt; &gt; &gt; Today's Topics:&gt; &gt;   


Thunderbird:



-------- Original Message --------
Subject: Mulberry-discuss Digest, Vol 15, Issue 15
From: <a href="mailto:mulberry-discuss-request@lists.mulberrymail.com">mulberry-discuss-request@lists.mulberrymail.com</a>
To: <a href="mailto:mulberry-discuss@lists.mulberrymail.com">mulberry-discuss@lists.mulberrymail.com</a>
Date: Mon Oct 29 2007 05:00:53 GMT+0300 (Arabic Standard Time)

<span class="quote">&gt; Send Mulberry-discuss mailing list submissions to
&gt; 	<a href="mailto:mulberry-discuss@lists.mulberrymail.com">mulberry-discuss@lists.mulberrymail.com</a>
&gt; 
&gt; To subscribe or unsubscribe via the World Wide Web, visit
&gt; 	<a href="http://lists.mulberrymail.com/mailman/listinfo/mulberry-discuss">http://lists.mulberrymail.com/mailman/listinfo/mulberry-discuss</a>
&gt; or, via email, send a message with subject or body 'help' to
&gt; 	<a href="mailto:mulberry-discuss-request@lists.mulberrymail.com">mulberry-discuss-request@lists.mulberrymail.com</a>
&gt; 
&gt; You can reach the person managing the list at
&gt; 	<a href="mailto:mulberry-discuss-owner@lists.mulberrymail.com">mulberry-discuss-owner@lists.mulberrymail.com</a>
&gt; 
&gt; When replying, please edit your Subject line so it is more specific
&gt; than &quot;Re: Contents of Mulberry-discuss digest...&quot;
&gt; 
&gt; 
&gt; Today's Topics:</span >
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c13" href="show_bug.cgi@id=25097.html#c13">
            #13</a> From 
          <a href="mailto:axel.grude&#64;gmail.com">Axel Grude</a>
          2012-08-23 05:36:47 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" ><span class=""><a href="smartTemplate-0.9.2pre24.xpi.1" name="attach_7350" title="test version 24">Created an attachment (id=7350)</a> <a href="https://www.mozdev.org/bugs/attachment.cgi?id=7350&amp;action=edit" title="test version 24">[details]</a></span>
test version 24

Can you try this version. it is a bit more cautious removing brs and stuff. The
methods of the original extension were &quot;fragile&quot;, I am switching to a &quot;Less
fragile&quot; mode, essentially replacing a &quot;House of cards&quot; with lego.
</pre>
    </div>
  <div class="bz_comment">
        <span class="bz_comment_head">
          <span class="comment_rule">-------</span> <i>Comment
          <a name="c14" href="show_bug.cgi@id=25097.html#c14">
            #14</a> From 
          <a href="mailto:axel.grude&#64;gmail.com">Axel Grude</a>
          2012-08-23 06:20:10 
          </i>
          <span class="comment_rule">-------</span>
        </span>
        


<pre class="bz_comment_text" >Marking this as fixed. If you still find other issues with this prerelease
version (such as weird behavior with removing line breaks), the please raise a
new bug.
</pre>
    </div>
</div>

</form>

<hr>
<i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">No search results available</font></i>

<br>
</div>



<div id="footer">
  <div class="intro"></div>




<ul id="useful-links">
  <li id="links-actions">
    <div class="label">Actions: </div><ul class="links">
  <li><a href="https://www.mozdev.org/bugs/">Home</a></li>
  <li><span class="separator">| </span><a href="https://www.mozdev.org/bugs/enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="https://www.mozdev.org/bugs/query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="https://www.mozdev.org/bugs/buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input class="txt" type="text" name="quicksearch">
    <input class="btn" type="submit" value="Find" id="find_bottom"></form></li>

  <li><span class="separator">| </span><a href="https://www.mozdev.org/bugs/report.cgi">Reports</a></li>

  <li>
    <span class="separator">| </span>
      <a href="https://www.mozdev.org/bugs/request.cgi">Requests</a></li>


      <li><span class="separator">| </span><a href="https://www.mozdev.org/bugs/createaccount.cgi">New&nbsp;Account</a></li>
      



      

        
      <li><span class="separator">| </span><a href="https://www.mozdev.org/bugs/show_bug.cgi?id=25097&amp;GoAheadAndLogIn=1">Log&nbsp;In</a></li>
</ul>
  </li>

  
    
    
    

  


  
</ul>

  <div class="outro"></div>
</div>

</body>
</html>